---
/**
 * BaseHead.astro
 * Hanterar metadata, SEO och resurser i <head>.
 */
import "../styles/global.css";
import { SITE_TITLE } from "../consts";
import SEO from "./SEO.astro";

interface HygraphImage {
  url: string;
  width?: number;
  height?: number;
}

interface Props {
  pageSeo?: {
    seoTitle?: string;
    seoDescription?: string;
    ogImage?: HygraphImage;
  };
  globalSeo?: {
    seoTitle?: string;
    seoDescription?: string;
    ogImage?: HygraphImage;
  };
  favicon?: HygraphImage; // Här lägger vi till faviconen
  fallbackTitle?: string;
}

const { pageSeo, globalSeo, fallbackTitle, favicon } = Astro.props;

/* --- SEO-LOGIK --- */
// Vi skickar bara själva "namnet" på sidan, SEO.astro sköter resten
const finalTitle =
  pageSeo?.seoTitle || globalSeo?.seoTitle || fallbackTitle || SITE_TITLE;

// Om beskrivning saknas skickar vi undefined, så kickar SEO.astro's fallback in
const finalDescription = pageSeo?.seoDescription || globalSeo?.seoDescription;

const finalImage = pageSeo?.ogImage?.url || globalSeo?.ogImage?.url;
---

<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

{favicon?.url && <link rel="icon" href={favicon.url} />}
{favicon?.url && <link rel="apple-touch-icon" href={favicon.url} />}

<link rel="preconnect" href="https://eu-west-2.graphassets.com" />
<link
  rel="preload"
  href="/fonts/poppins-v24-latin-regular.woff2"
  as="font"
  type="font/woff2"
  crossorigin
/>
<link
  rel="preload"
  href="/fonts/poppins-v24-latin-700.woff2"
  as="font"
  type="font/woff2"
  crossorigin
/>
<link rel="sitemap" href="/sitemap-index.xml" />
<link
  rel="alternate"
  type="application/rss+xml"
  title={SITE_TITLE}
  href={new URL("rss.xml", Astro.site)}
/>
<meta name="generator" content={Astro.generator} />

<SEO title={finalTitle} description={finalDescription} ogImage={finalImage} />
