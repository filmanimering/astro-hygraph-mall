---
const today = new Date();
const HYGRAPH_ENDPOINT = import.meta.env.HYGRAPH_ENDPOINT;

const query = `
query GetFooterSettings {
  globalSettings {
    navigation {
      ... on Navigation {
        label
        url
      }
    }
    siteName
    footerText
    contactInfo {
      html
    }
  }
}`;

const response = await fetch(HYGRAPH_ENDPOINT, {
	method: "POST",
	headers: { "Content-Type": "application/json" },
	body: JSON.stringify({ query }),
});

const json = await response.json();
const settings = json.data?.globalSettings[0] || {};
const { siteName, footerText, contactInfo, navigation = [] } = settings;
const contactHtml = contactInfo?.html;
---

<footer class="w-full bg-slate-50 border-t border-slate-200 mt-12">
	<div class="max-w-7xl mx-auto px-6 py-10">
		<div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
			{/* Kolumn 1: Branding */}
			<div class="flex flex-col gap-2 text-center md:text-left">
				{
					siteName && (
						<h2 class="text-lg font-black tracking-tighter text-slate-900 uppercase">
							{siteName}
						</h2>
					)
				}
				{
					footerText && (
						<p class="text-slate-500 text-sm leading-snug max-w-xs mx-auto md:mx-0">
							{footerText}
						</p>
					)
				}
			</div>

			{/* Kolumn 2: Navigation */}
			<div class="flex flex-col items-center gap-2">
				{
					navigation.length > 0 &&
						navigation.map((link: any) => (
							<a
								href={link.url}
								class="text-slate-600 hover:text-blue-600 font-semibold transition-colors "
							>
								{link.label}
							</a>
						))
				}
			</div>

			{/* Kolumn 3: Kontakt */}
			<div class="flex flex-col items-center md:items-end">
				{
					contactHtml && (
						<div
							class="prose prose-sm prose-slate prose-p:mb-0 prose-p:leading-tight text-slate-600 text-center md:text-right"
							set:html={contactHtml}
						/>
					)
				}
			</div>
		</div>

		{/* Bottom Bar - Minimalistisk copyright */}
		<div class="mt-8 pt-6 border-t border-slate-200/50 flex justify-center">
			<p class="text-sm text-slate-800 font-medium text-center">
				&copy; {today.getFullYear()}
				{siteName}
			</p>
		</div>
	</div>
</footer>
