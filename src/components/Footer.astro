---
const today = new Date();
const HYGRAPH_ENDPOINT = import.meta.env.HYGRAPH_ENDPOINT;

const query = `
query GetFooterSettings {
  globalSettings {
    navigation {
      ... on Navigation {
        label
        url
      }
    }
    siteName
    footerText
    contactInfo {
      html
    }
  }
}`;

const response = await fetch(HYGRAPH_ENDPOINT, {
	method: "POST",
	headers: { "Content-Type": "application/json" },
	body: JSON.stringify({ query }),
});

const json = await response.json();
const settings = json.data?.globalSettings[0] || {};
const { siteName, footerText, contactInfo, navigation = [] } = settings;
const contactHtml = contactInfo?.html;
---

<footer class="w-full bg-slate-100 border-t border-slate-200 mt-12">
	<div class="max-w-5xl mx-auto px-6 py-8">
		{/* Rad 1: Kompakt horisontell meny */}
		<nav class="flex flex-wrap justify-center gap-x-6 gap-y-2 mb-6">
			{
				navigation.map((link: any) => (
					<a
						href={link.url}
						class="text-sm   tracking-wide text-slate-700 hover:text-slate-500"
					>
						{link.label}
					</a>
				))
			}
		</nav>

		{/* Rad 2: Två kolumner med mindre text */}
		<div
			class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-2 border-t border-slate-100 pt-2"
		>
			{/* Vänster: Info */}
			<div class="text-center">
				<!-- <h2 class="text-sm text-slate-950 mb-1">
					{siteName}
				</h2> -->
				<p
					class="text-sm italic text-slate-950 leading-relaxed max-w-sm mx-auto md:mx-0"
				>
					{footerText}
				</p>
			</div>

			{/* Höger: Kontakt */}
			<div class="flex flex-col items-center md:items-end">
				<div
					class="prose prose-xs prose-slate
                           prose-p:mb-0 prose-p:leading-tight
                           text-sm text-slate-950 text-center"
					set:html={contactHtml}
				/>
			</div>
		</div>

		{/* Rad 3: Centrerad Copyright */}
		<div class="pt-2 border-t border-slate-100 text-center">
			<p class="text-sm text-slate-950 tracking-wide">
				&copy; {today.getFullYear()}
				{siteName}
			</p>
		</div>
	</div>
</footer>
